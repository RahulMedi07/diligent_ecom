import sqlite3
import pandas as pd

# Step 1: Connect to the database
conn = sqlite3.connect('ecommerce.db')

# Step 2: Write the SQL query
query = """
SELECT 
    c.name AS customer_name,
    p.name AS product_name,
    oi.quantity,
    p.price,
    (oi.quantity * p.price) AS total_amount,
    o.order_id
FROM orders o
JOIN order_items oi ON o.order_id = oi.order_id
JOIN products p ON oi.product_id = p.product_id
JOIN customers c ON o.customer_id = c.customer_id;
"""

# Step 3: Run the query and store result in a DataFrame
result = pd.read_sql_query(query, conn)

# Step 4: See first 5 rows
print(result.head())

# Step 5: Close the database connection
conn.close()
